<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Archery Game - EXTREME Bow Graphics + Audio</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <style>
      body{
        background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
        margin:20px;
        overflow: hidden;
      }
      svg{
        width:100%;
        height:100%;
        position:fixed;
        top:0;
        left:0;
        filter: drop-shadow(0 0 20px rgba(136, 206, 2, 0.1));
      }
      span{
        color:white;
        font-family:'Orbitron', sans-serif;
        opacity:.8;
        position: fixed;
        bottom: 20px;
        left: 20px;
        font-size: 16px;
        text-shadow: 0 0 10px rgba(136, 206, 2, 0.5);
      }
      
      /* Multiple Canvas Layers for Complex Effects */
      #particleCanvas {
        position: fixed;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: 100;
      }
      
      #lightingCanvas {
        position: fixed;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: 90;
        mix-blend-mode: screen;
      }
      
      #atmosphereCanvas {
        position: fixed;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: 80;
        opacity: 0.6;
      }
      

      /* ULTRA-MODERN THEME PANEL - TOP LEFT HORIZONTAL LAYOUT */
.customization-panel {
  position: fixed;
  top: 20px;
  left: 20px;                      /* Changed from right: 20px */
  background: linear-gradient(145deg, rgba(13, 20, 35, 0.95), rgba(25, 32, 45, 0.98));
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 24px;
  padding: 16px 24px;              /* Adjusted padding for horizontal layout */
  font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
  color: #ffffff;
  min-width: 480px;                /* Much wider */
  max-width: 600px;                /* Maximum horizontal width */
  width: auto;                     /* Allow natural width */
  height: auto;                    /* Allow natural height */
  z-index: 1000;
  backdrop-filter: blur(25px) saturate(180%);
  box-shadow: 
    0 25px 50px -12px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.05),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  transform-origin: top left;      /* Changed from top right */
  
  /* Modern glass morphism effect */
  background-attachment: fixed;
  
  /* Subtle animation on hover */
  animation: panelGlow 6s ease-in-out infinite alternate;
}

/* HORIZONTAL PANEL HEADER */
.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;             /* Reduced for horizontal layout */
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  position: relative;
}

/* HORIZONTAL OPTION GROUPS LAYOUT */
.panel-content {
  display: flex;                   /* Make content horizontal */
  flex-direction: row;             /* Arrange groups horizontally */
  gap: 32px;                       /* Space between groups */
  align-items: flex-start;         /* Align groups to top */
  flex-wrap: wrap;                 /* Allow wrapping on smaller screens */
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.option-group {
  margin-bottom: 0;                /* Remove bottom margin */
  position: relative;
  flex: 1;                         /* Equal width distribution */
  min-width: 140px;                /* Minimum width per group */
}

.option-group::before {
  content: '';
  position: absolute;
  left: 0;
  top: -12px;
  right: 0;
  height: 2px;                     /* Horizontal line instead of vertical */
  background: linear-gradient(90deg, #88ce02, #00ff88);
  border-radius: 1px;
  opacity: 0.3;
}

/* MODERN OPTION LABELS - HORIZONTAL */
.option-label {
  display: flex;
  align-items: center;
  margin-bottom: 12px;
  font-size: 12px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.8);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  position: relative;
  text-align: center;              /* Center align for horizontal layout */
  justify-content: center;         /* Center the label */
}

.option-label::after {
  display: none;                   /* Remove the line for horizontal layout */
}

/* HORIZONTAL OPTION BUTTONS */
.option-buttons {
  display: flex;
  gap: 6px;                        /* Smaller gap for horizontal layout */
  flex-wrap: wrap;
  justify-content: center;         /* Center buttons in each group */
}

.option-btn {
  padding: 8px 12px;               /* Smaller padding for compact horizontal layout */
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
  color: rgba(255, 255, 255, 0.9);
  cursor: pointer;
  border-radius: 12px;
  font-size: 10px;                 /* Slightly smaller font for horizontal layout */
  font-weight: 600;
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(10px);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  white-space: nowrap;             /* Prevent text wrapping */
  
  /* Modern typography */
  font-family: inherit;
  line-height: 1.2;
}

/* SETTINGS BUTTON POSITION (TOP LEFT) */
.open-btn {
  position: fixed;
  top: 25px;
  left: 25px;                      /* Changed from right: 25px */
  background: linear-gradient(135deg, #88ce02, #00ff88);
  border: none;
  border-radius: 18px;
  width: 50px;
  height: 50px;
  cursor: pointer;
  font-size: 18px;
  color: #0a0f1a;
  font-weight: 700;
  box-shadow: 
    0 12px 30px rgba(136, 206, 2, 0.4),
    0 0 0 1px rgba(136, 206, 2, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  z-index: 1001;
  display: none;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

/* PANEL ANIMATION STATES - LEFT SIDE */
.panel-closed {
  transform: scale(0.95) translateX(-100px);  /* Slide left instead of right */
  opacity: 0;
  pointer-events: none;
}

/* AUDIO INDICATOR POSITION - ADJUSTED FOR LEFT PANEL */
.audio-indicator {
  position: fixed;
  top: 85px;
  left: 25px;                      /* Changed from right: 25px */
  background: linear-gradient(135deg, rgba(136, 206, 2, 0.1), rgba(0, 255, 136, 0.1));
  padding: 12px 18px;
  border-radius: 16px;
  font-family: inherit;
  color: #88ce02;
  font-size: 12px;
  font-weight: 600;
  z-index: 999;
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(136, 206, 2, 0.2);
  box-shadow: 0 8px 25px rgba(136, 206, 2, 0.15);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* RESPONSIVE DESIGN FOR HORIZONTAL LAYOUT */
@media (max-width: 768px) {
  .customization-panel {
    min-width: 320px;              /* Adjust for mobile */
    max-width: 90vw;               /* Use viewport width */
    padding: 12px 16px;
    top: 15px;
    left: 15px;
  }
  
  .panel-content {
    flex-direction: column;        /* Stack vertically on mobile */
    gap: 16px;
  }
  
  .option-group {
    min-width: auto;
  }
  
  .option-btn {
    padding: 6px 10px;
    font-size: 9px;
  }
  
  .open-btn {
    width: 45px;
    height: 45px;
    font-size: 16px;
    top: 20px;
    left: 20px;
  }
}

@media (max-width: 600px) {
  .customization-panel {
    min-width: 280px;
    flex-direction: column;
  }
  
  .panel-content {
    flex-direction: column;
    gap: 12px;
  }
}

/* VERY WIDE SCREENS - EXPAND HORIZONTALLY */
@media (min-width: 1400px) {
  .customization-panel {
    min-width: 550px;
    max-width: 700px;
  }
  
  .panel-content {
    gap: 40px;
  }
}

      
      /* Audio Control Indicator */
      .audio-indicator {
        position: fixed;
        top: 100px;
        right: 30px;
        background: rgba(136, 206, 2, 0.2);
        padding: 10px 15px;
        border-radius: 20px;
        font-family: 'Orbitron', sans-serif;
        color: #88ce02;
        font-size: 12px;
        z-index: 999;
        opacity: 0;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(136, 206, 2, 0.3);
      }
      
      .audio-indicator.show {
        opacity: 1;
      }
      
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- Multiple Canvas Layers for Complex Effects -->
    <canvas id="atmosphereCanvas"></canvas>
    <canvas id="lightingCanvas"></canvas>
    <canvas id="particleCanvas"></canvas>

    <!-- Audio Indicator -->
    <div class="audio-indicator" id="audioIndicator">üîä Audio Ready</div>

    <!-- Open Button (appears when panel is closed) -->
    <button class="open-btn" id="openBtn" onclick="openPanel()">‚öô</button>

    <!-- Enhanced Customization Panel -->
    <div class="customization-panel" id="customPanel">
      <div class="panel-header">
        <h3 class="panel-title">BOW EFFECTS üî•</h3>
        <button class="close-btn" onclick="closePanel()">√ó</button>
      </div>
      
      <div class="panel-content">
        <div class="option-group">
          <span class="option-label">üèπ Arrow Effects:</span>
          <div class="option-buttons">
            <button class="option-btn active" onclick="changeArrowStyle('default', event)">‚ö° Default</button>
            <button class="option-btn" onclick="changeArrowStyle('fire', event)">üî• Inferno</button>
            <button class="option-btn" onclick="changeArrowStyle('ice', event)">‚ùÑÔ∏è Blizzard</button>
            <button class="option-btn" onclick="changeArrowStyle('gold', event)">‚ú® Divine</button>
          </div>
        </div>
        
        <div class="option-group">
          <span class="option-label">üéØ Target Effects:</span>
          <div class="option-buttons">
            <button class="option-btn active" onclick="changeTargetStyle('classic', event)">üéØ Classic+</button>
            <button class="option-btn" onclick="changeTargetStyle('modern', event)">üîµ Hologram</button>
            <button class="option-btn" onclick="changeTargetStyle('neon', event)">üí´ Plasma</button>
            <button class="option-btn" onclick="changeTargetStyle('wooden', event)">ü™µ Ancient</button>
          </div>
        </div>
        
        <div class="option-group">
          <span class="option-label">üèπ Bow Power:</span>
          <div class="option-buttons">
            <button class="option-btn active" onclick="changeBowColor('#88ce02', event)">üü¢ Nature</button>
            <button class="option-btn" onclick="changeBowColor('#ff6b35', event)">üî• Phoenix</button>
            <button class="option-btn" onclick="changeBowColor('#4ecdc4', event)">‚ùÑÔ∏è Frost</button>
            <button class="option-btn" onclick="changeBowColor('#ffe66d', event)">‚ö° Thunder</button>
            <button class="option-btn" onclick="changeBowColor('#ff0080', event)">üåô Void</button>
          </div>
        </div>
      </div>
    </div>

    <svg id="game" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 400" overflow="visible">
      <defs>
        
        <!-- Nature Bow Effects -->
        <radialGradient id="natureBowGradient" cx="0.5" cy="0.5" r="1.2">
          <stop offset="0%" stop-color="#88ce02" stop-opacity="1"/>
          <stop offset="30%" stop-color="#66aa00" stop-opacity="0.8"/>
          <stop offset="70%" stop-color="#44cc44" stop-opacity="0.6"/>
          <stop offset="100%" stop-color="#226600" stop-opacity="0"/>
        </radialGradient>
        
        <radialGradient id="natureBowAura" cx="0.5" cy="0.5" r="2">
          <stop offset="0%" stop-color="#88ce02" stop-opacity="0.4"/>
          <stop offset="50%" stop-color="#66dd00" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#44aa00" stop-opacity="0"/>
        </radialGradient>

        <!-- Phoenix Bow Effects -->
        <radialGradient id="phoenixBowGradient" cx="0.5" cy="0.3" r="1.5">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="1"/>
          <stop offset="20%" stop-color="#ffff99" stop-opacity="0.9"/>
          <stop offset="40%" stop-color="#ff6b35" stop-opacity="0.8"/>
          <stop offset="70%" stop-color="#cc3300" stop-opacity="0.6"/>
          <stop offset="100%" stop-color="#660000" stop-opacity="0"/>
        </radialGradient>
        
        <radialGradient id="phoenixBowFlames" cx="0.5" cy="0.5" r="3">
          <stop offset="0%" stop-color="#ff6b35" stop-opacity="0.6"/>
          <stop offset="30%" stop-color="#ff4400" stop-opacity="0.4"/>
          <stop offset="60%" stop-color="#cc2200" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#880000" stop-opacity="0"/>
        </radialGradient>

        <!-- Frost Bow Effects -->
        <radialGradient id="frostBowGradient" cx="0.5" cy="0.3" r="1.3">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="1"/>
          <stop offset="25%" stop-color="#e6f7ff" stop-opacity="0.9"/>
          <stop offset="50%" stop-color="#4ecdc4" stop-opacity="0.8"/>
          <stop offset="75%" stop-color="#2288cc" stop-opacity="0.6"/>
          <stop offset="100%" stop-color="#004488" stop-opacity="0"/>
        </radialGradient>
        
        <radialGradient id="frostBowCrystals" cx="0.5" cy="0.5" r="2.5">
          <stop offset="0%" stop-color="#4ecdc4" stop-opacity="0.5"/>
          <stop offset="40%" stop-color="#66ccff" stop-opacity="0.3"/>
          <stop offset="100%" stop-color="#0066cc" stop-opacity="0"/>
        </radialGradient>

        <!-- Thunder Bow Effects -->
        <radialGradient id="thunderBowGradient" cx="0.5" cy="0.2" r="1.4">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="1"/>
          <stop offset="15%" stop-color="#ffff99" stop-opacity="0.95"/>
          <stop offset="35%" stop-color="#ffe66d" stop-opacity="0.8"/>
          <stop offset="60%" stop-color="#ccaa00" stop-opacity="0.6"/>
          <stop offset="100%" stop-color="#666600" stop-opacity="0"/>
        </radialGradient>
        
        <radialGradient id="thunderBowLightning" cx="0.5" cy="0.5" r="3">
          <stop offset="0%" stop-color="#ffe66d" stop-opacity="0.7"/>
          <stop offset="30%" stop-color="#ffcc00" stop-opacity="0.4"/>
          <stop offset="70%" stop-color="#9999ff" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#3333cc" stop-opacity="0"/>
        </radialGradient>

        <!-- Void Bow Effects -->
        <radialGradient id="voidBowGradient" cx="0.5" cy="0.4" r="1.1">
          <stop offset="0%" stop-color="#ff00ff" stop-opacity="0.9"/>
          <stop offset="30%" stop-color="#ff0080" stop-opacity="0.8"/>
          <stop offset="60%" stop-color="#cc0066" stop-opacity="0.6"/>
          <stop offset="100%" stop-color="#440044" stop-opacity="0"/>
        </radialGradient>
        
        <radialGradient id="voidBowDarkness" cx="0.5" cy="0.5" r="2.8">
          <stop offset="0%" stop-color="#ff0080" stop-opacity="0.3"/>
          <stop offset="50%" stop-color="#880044" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#220022" stop-opacity="0"/>
        </radialGradient>

        <!-- EXTREME Trajectory Gradients for Each Arrow Type -->
        
        <!-- Fire Trajectory Effects -->
        <linearGradient id="fireTrajectoryGradient">
            <stop offset="0%" stop-color="#ff0000" stop-opacity="0.9"/>
            <stop offset="25%" stop-color="#ff4500" stop-opacity="0.8"/>
            <stop offset="50%" stop-color="#ffaa00" stop-opacity="0.7"/>
            <stop offset="75%" stop-color="#ff6600" stop-opacity="0.8"/>
            <stop offset="100%" stop-color="#cc3300" stop-opacity="0.6"/>
        </linearGradient>
        
        <radialGradient id="fireTrajectoryGlow" cx="0.5" cy="0.5" r="0.8">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="0.6"/>
          <stop offset="30%" stop-color="#ffaa00" stop-opacity="0.4"/>
          <stop offset="70%" stop-color="#ff4500" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#660000" stop-opacity="0"/>
        </radialGradient>

        <!-- Ice Trajectory Effects -->
        <linearGradient id="iceTrajectoryGradient">
            <stop offset="0%" stop-color="#ffffff" stop-opacity="0.9"/>
            <stop offset="25%" stop-color="#b3e5fc" stop-opacity="0.8"/>
            <stop offset="50%" stop-color="#87ceeb" stop-opacity="0.7"/>
            <stop offset="75%" stop-color="#4682b4" stop-opacity="0.8"/>
            <stop offset="100%" stop-color="#1976d2" stop-opacity="0.6"/>
        </linearGradient>
        
        <radialGradient id="iceTrajectoryGlow" cx="0.5" cy="0.5" r="0.8">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="0.6"/>
          <stop offset="30%" stop-color="#b3e5fc" stop-opacity="0.4"/>
          <stop offset="70%" stop-color="#4682b4" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#003366" stop-opacity="0"/>
        </radialGradient>

        <!-- Gold Trajectory Effects -->
        <linearGradient id="goldTrajectoryGradient">
            <stop offset="0%" stop-color="#ffffff" stop-opacity="0.9"/>
            <stop offset="25%" stop-color="#ffff99" stop-opacity="0.8"/>
            <stop offset="50%" stop-color="#ffd700" stop-opacity="0.8"/>
            <stop offset="75%" stop-color="#ffaa00" stop-opacity="0.7"/>
            <stop offset="100%" stop-color="#ff8c00" stop-opacity="0.6"/>
        </linearGradient>
        
        <radialGradient id="goldTrajectoryGlow" cx="0.5" cy="0.5" r="0.8">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="0.7"/>
          <stop offset="30%" stop-color="#ffd700" stop-opacity="0.5"/>
          <stop offset="70%" stop-color="#ffaa00" stop-opacity="0.3"/>
          <stop offset="100%" stop-color="#cc6600" stop-opacity="0"/>
        </radialGradient>

        <!-- Default Trajectory Effects -->
        <linearGradient id="defaultTrajectoryGradient">
            <stop offset="0%" stop-color="#fff" stop-opacity="0.6"/>
            <stop offset="50%" stop-color="#88ce02" stop-opacity="0.4"/>
            <stop offset="100%" stop-color="#fff" stop-opacity="0.2"/>
        </linearGradient>
        
        <radialGradient id="defaultTrajectoryGlow" cx="0.5" cy="0.5" r="0.8">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="0.3"/>
          <stop offset="50%" stop-color="#88ce02" stop-opacity="0.2"/>
          <stop offset="100%" stop-color="#88ce02" stop-opacity="0"/>
        </radialGradient>

        <!-- Ultra Target Effects -->
        <radialGradient id="extremeTargetGlow" cx="0.5" cy="0.5" r="1.2">
          <stop offset="0%" stop-color="#ffffff" stop-opacity="0.3"/>
          <stop offset="40%" stop-color="#ffff99" stop-opacity="0.2"/>
          <stop offset="70%" stop-color="#ff9900" stop-opacity="0.1"/>
          <stop offset="100%" stop-color="#ff3300" stop-opacity="0"/>
        </radialGradient>
        
        <!-- EXTREME Arrow Definitions -->
        <g id="arrow-default">
            <line x2="60" fill="none" stroke="#888" stroke-width="2.5" />
            <polygon fill="#888" points="64 0 58 2 56 0 58 -2" />
            <polygon fill="#88ce02" points="2 -3 -4 -3 -1 0 -4 3 2 3 5 0" />
            <circle cx="0" cy="0" r="3" fill="#88ce02" opacity="0.3">
              <animate attributeName="r" values="3;5;3" dur="1s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.3;0.1;0.3" dur="1s" repeatCount="indefinite"/>
            </circle>
        </g>
        
        <!-- EXTREME Fire Arrow -->
        <g id="arrow-fire">
            <line x2="60" fill="none" stroke="#d32f2f" stroke-width="3" />
            <polygon fill="#d32f2f" points="64 0 58 2 56 0 58 -2" />
            <polygon fill="#ff4500" points="2 -3 -4 -3 -1 0 -4 3 2 3 5 0" />
            <line x2="58" fill="none" stroke="#ff9900" stroke-width="1.5" opacity="0.8" />
            <g class="extreme-fire-trail">
              <circle cx="-8" cy="0" r="3" fill="#ff4500" opacity="0.9">
                <animate attributeName="opacity" values="0.9;0.3;0;0.9" dur="0.15s" repeatCount="indefinite"/>
                <animate attributeName="r" values="3;5;1;3" dur="0.15s" repeatCount="indefinite"/>
              </circle>
              <circle cx="-12" cy="1" r="2.5" fill="#ffaa00" opacity="0.8">
                <animate attributeName="opacity" values="0.8;0.2;0;0.8" dur="0.2s" repeatCount="indefinite"/>
                <animate attributeName="cy" values="1;3;-2;1" dur="0.2s" repeatCount="indefinite"/>
              </circle>
            </g>
        </g>
        
        <!-- EXTREME Ice Arrow -->
        <g id="arrow-ice">
            <line x2="60" fill="none" stroke="#1976d2" stroke-width="3" />
            <polygon fill="#1976d2" points="64 0 58 2 56 0 58 -2" />
            <polygon fill="#4ecdc4" points="2 -3 -4 -3 -1 0 -4 3 2 3 5 0" />
            <line x2="58" fill="none" stroke="#87ceeb" stroke-width="1.5" opacity="0.9" />
            <g class="extreme-ice-trail">
              <polygon points="-10,0 -8,-3 -6,0 -8,3" fill="#87ceeb" opacity="0.9">
                <animate attributeName="opacity" values="0.9;0.3;0;0.9" dur="0.6s" repeatCount="indefinite"/>
                <animateTransform attributeName="transform" type="rotate" values="0;360" dur="1.5s" repeatCount="indefinite"/>
              </polygon>
            </g>
        </g>
        
        <!-- EXTREME Gold Arrow -->
        <g id="arrow-gold">
            <line x2="60" fill="none" stroke="#f57c00" stroke-width="3" />
            <polygon fill="#f57c00" points="64 0 58 2 56 0 58 -2" />
            <polygon fill="#ffd700" points="2 -3 -4 -3 -1 0 -4 3 2 3 5 0" />
            <polygon fill="#ffecb3" points="1 -2 -2 -2 -1 0 -2 2 1 2 3 0" opacity="1" />
            <line x2="58" fill="none" stroke="#ffff99" stroke-width="1.5" opacity="0.8" />
            <g class="extreme-gold-trail">
              <circle cx="-8" cy="0" r="2" fill="#ffd700" opacity="1">
                <animate attributeName="opacity" values="1;0;1" dur="0.3s" repeatCount="indefinite"/>
                <animate attributeName="r" values="2;3;2" dur="0.3s" repeatCount="indefinite"/>
              </circle>
            </g>
        </g>
      </defs>
      
      <!-- EXTREME Enhanced trajectory arcs -->
      
      <!-- Default Arc -->
      <g id="trajectory-default">
        <path id="arc" fill="none" stroke="url(#defaultTrajectoryGradient)" stroke-width="6" d="M100,250c250-400,550-400,800,0" pointer-events="none"/>
        <path id="arcGlow" fill="none" stroke="url(#defaultTrajectoryGlow)" stroke-width="12" opacity="0.3" d="M100,250c250-400,550-400,800,0" pointer-events="none"/>
      </g>

      <!-- Fire Arc -->
      <g id="trajectory-fire" style="display:none">
        <path id="arc-fire" fill="none" stroke="url(#fireTrajectoryGradient)" stroke-width="8" d="M100,250c250-400,550-400,800,0" pointer-events="none">
          <animate attributeName="stroke-opacity" values="0.6;1;0.6" dur="0.5s" repeatCount="indefinite"/>
        </path>
        <path id="arcGlow-fire" fill="none" stroke="url(#fireTrajectoryGlow)" stroke-width="20" opacity="0.4" d="M100,250c250-400,550-400,800,0" pointer-events="none"/>
      </g>

      <!-- Ice Arc -->
      <g id="trajectory-ice" style="display:none">
        <path id="arc-ice" fill="none" stroke="url(#iceTrajectoryGradient)" stroke-width="8" d="M100,250c250-400,550-400,800,0" pointer-events="none">
          <animate attributeName="stroke-dasharray" values="0,1000;20,980;0,1000" dur="2s" repeatCount="indefinite"/>
        </path>
        <path id="arcGlow-ice" fill="none" stroke="url(#iceTrajectoryGlow)" stroke-width="18" opacity="0.5" d="M100,250c250-400,550-400,800,0" pointer-events="none"/>
      </g>

      <!-- Gold Arc -->
      <g id="trajectory-gold" style="display:none">
        <path id="arc-gold" fill="none" stroke="url(#goldTrajectoryGradient)" stroke-width="8" d="M100,250c250-400,550-400,800,0" pointer-events="none"/>
        <path id="arcGlow-gold" fill="none" stroke="url(#goldTrajectoryGlow)" stroke-width="22" opacity="0.6" d="M100,250c250-400,550-400,800,0" pointer-events="none">
          <animate attributeName="opacity" values="0.6;0.9;0.6" dur="1s" repeatCount="indefinite"/>
        </path>
      </g>
        
      <!-- EXTREME Target Groups -->
      <g id="target-classic">
          <circle cx="900" cy="249.5" r="80" fill="url(#extremeTargetGlow)" opacity="0">
            <animate attributeName="opacity" values="0;0.6;0" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="905" cy="254.5" r="45" fill="#000" opacity="0.4"/>
          <path fill="#FFF" d="M924.2,274.2c-21.5,21.5-45.9,19.9-52,3.2c-4.4-12.1,2.4-29.2,14.2-41c11.8-11.8,29-18.6,41-14.2 C944.1,228.3,945.7,252.8,924.2,274.2z" />
          <path fill="#F4531C" d="M915.8,265.8c-14.1,14.1-30.8,14.6-36,4.1c-4.1-8.3,0.5-21.3,9.7-30.5s22.2-13.8,30.5-9.7 C930.4,235,929.9,251.7,915.8,265.8z" />
          <path fill="#FFF" d="M908.9,258.9c-8,8-17.9,9.2-21.6,3.5c-3.2-4.9-0.5-13.4,5.6-19.5c6.1-6.1,14.6-8.8,19.5-5.6 C918.1,241,916.9,250.9,908.9,258.9z" />
          <path fill="#F4531C" d="M903.2,253.2c-2.9,2.9-6.7,3.6-8.3,1.7c-1.5-1.8-0.6-5.4,2-8c2.6-2.6,6.2-3.6,8-2 C906.8,246.5,906.1,250.2,903.2,253.2z" />
          <circle cx="900" cy="249.5" r="4" fill="#fff" opacity="1">
            <animate attributeName="opacity" values="1;0.3;1" dur="1s" repeatCount="indefinite"/>
            <animate attributeName="r" values="4;6;4" dur="1s" repeatCount="indefinite"/>
          </circle>
      </g>
      
      <g id="target-modern" style="display:none">
          <circle cx="900" cy="249.5" r="80" fill="url(#extremeTargetGlow)" opacity="0">
            <animate attributeName="opacity" values="0;0.8;0" dur="1.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="905" cy="254.5" r="45" fill="#000066" opacity="0.3"/>
          <circle cx="900" cy="249.5" r="40" fill="#2196F3" />
          <circle cx="900" cy="249.5" r="30" fill="#FFF" />
          <circle cx="900" cy="249.5" r="20" fill="#2196F3" />
          <circle cx="900" cy="249.5" r="10" fill="#FFF" />
          <circle cx="900" cy="249.5" r="5" fill="#FF5722" />
      </g>
      
      <g id="target-neon" style="display:none">
          <circle cx="900" cy="249.5" r="100" fill="#00ffff" opacity="0">
            <animate attributeName="opacity" values="0;0.2;0" dur="0.8s" repeatCount="indefinite"/>
          </circle>
          <circle cx="905" cy="254.5" r="45" fill="#000033" opacity="0.8"/>
          <circle cx="900" cy="249.5" r="40" fill="none" stroke="#00ffff" stroke-width="4">
            <animate attributeName="stroke-opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite"/>
          </circle>
          <circle cx="900" cy="249.5" r="30" fill="none" stroke="#ff00ff" stroke-width="3">
            <animate attributeName="stroke-opacity" values="0.5;1;0.5" dur="0.7s" repeatCount="indefinite"/>
          </circle>
          <circle cx="900" cy="249.5" r="20" fill="none" stroke="#ffff00" stroke-width="3">
            <animate attributeName="stroke-opacity" values="0.4;1;0.4" dur="0.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="900" cy="249.5" r="10" fill="#ff0080" opacity="1">
            <animate attributeName="opacity" values="1;0.2;1" dur="0.3s" repeatCount="indefinite"/>
          </circle>
      </g>
      
      <g id="target-wooden" style="display:none">
          <circle cx="900" cy="249.5" r="70" fill="#8D6E63" opacity="0">
            <animate attributeName="opacity" values="0;0.3;0" dur="5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="905" cy="254.5" r="45" fill="#2E1B12" opacity="0.5"/>
          <circle cx="900" cy="249.5" r="40" fill="#8D6E63" stroke="#5D4037" stroke-width="3" />
          <circle cx="900" cy="249.5" r="30" fill="#FFF8E1" />
          <circle cx="900" cy="249.5" r="20" fill="#8D6E63" />
          <circle cx="900" cy="249.5" r="10" fill="#FFF8E1" />
          <circle cx="900" cy="249.5" r="5" fill="#D32F2F" />
      </g>
      
      <!-- EXTREME ENHANCED BOW WITH DYNAMIC THEME EFFECTS -->
      <g id="bow" fill="none" stroke-linecap="round" vector-effect="non-scaling-stroke" pointer-events="none">
        
        <!-- Base Bow Structure -->
        <polyline fill="none" stroke="#666" stroke-linecap="round" points="90,202 90,252 90,302" stroke-width="1" opacity="0.4"/>
        <polyline fill="none" stroke="#aaa" stroke-linecap="round" points="89,201 89,251 89,301" stroke-width="2" opacity="0.7"/>
        <polyline fill="none" stroke="#ddd" stroke-linecap="round" points="88,200 88,250 88,300" stroke-width="3"/>
        
        <!-- Dynamic Bow String with Theme Color -->
        <path fill="none" stroke="#88ce02" stroke-width="4" stroke-linecap="round" d="M88,300 c0-10.1,12-25.1,12-50s-12-39.9-12-50" id="bowString" opacity="0.9"/>
        <path fill="none" stroke="#88ce02" stroke-width="2" stroke-linecap="round" d="M88,300 c0-10.1,12-25.1,12-50s-12-39.9-12-50" opacity="0.6"/>
        
        <!-- NATURE BOW EFFECTS -->
        <g id="bow-nature-effects" opacity="1">
          <!-- Nature Aura -->
          <circle cx="100" cy="250" r="25" fill="url(#natureBowAura)" opacity="0.4">
            <animate attributeName="r" values="25;35;25" dur="3s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.4;0.6;0.4" dur="3s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Nature Leaves Effect -->
          <g class="nature-leaves">
            <ellipse cx="85" cy="220" rx="2" ry="4" fill="#88ce02" opacity="0.8">
              <animateTransform attributeName="transform" type="rotate" values="0 85 220;360 85 220" dur="4s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.3;0.8" dur="2s" repeatCount="indefinite"/>
            </ellipse>
            <ellipse cx="95" cy="280" rx="2" ry="4" fill="#66aa00" opacity="0.7">
              <animateTransform attributeName="transform" type="rotate" values="360 95 280;0 95 280" dur="3.5s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.7;0.2;0.7" dur="2.5s" repeatCount="indefinite"/>
            </ellipse>
            <ellipse cx="110" cy="240" rx="1.5" ry="3" fill="#44cc44" opacity="0.6">
              <animateTransform attributeName="transform" type="rotate" values="0 110 240;360 110 240" dur="5s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.6;0.1;0.6" dur="3s" repeatCount="indefinite"/>
            </ellipse>
          </g>
          
          <!-- Nature Energy Lines -->
          <g class="nature-energy" opacity="0.5">
            <line x1="85" y1="210" x2="115" y2="250" stroke="#88ce02" stroke-width="1" opacity="0.6">
              <animate attributeName="opacity" values="0.6;0.2;0.6" dur="1.5s" repeatCount="indefinite"/>
            </line>
            <line x1="85" y1="290" x2="115" y2="250" stroke="#66aa00" stroke-width="1" opacity="0.5">
              <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.8s" repeatCount="indefinite"/>
            </line>
          </g>
        </g>

        <!-- PHOENIX BOW EFFECTS -->
        <g id="bow-phoenix-effects" opacity="0" style="display:none">
          <!-- Phoenix Flames Aura -->
          <circle cx="100" cy="250" r="30" fill="url(#phoenixBowFlames)" opacity="0.6">
            <animate attributeName="r" values="30;45;30" dur="1.5s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.6;0.9;0.6" dur="1.5s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Phoenix Fire Particles -->
          <g class="phoenix-flames">
            <circle cx="80" cy="230" r="3" fill="#ff6b35" opacity="0.9">
              <animate attributeName="cy" values="230;220;230" dur="0.8s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.9;0.3;0.9" dur="0.8s" repeatCount="indefinite"/>
              <animate attributeName="r" values="3;5;3" dur="0.8s" repeatCount="indefinite"/>
            </circle>
            <circle cx="120" cy="270" r="2.5" fill="#ff4400" opacity="0.8">
              <animate attributeName="cy" values="270;260;270" dur="1s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.2;0.8" dur="1s" repeatCount="indefinite"/>
            </circle>
            <circle cx="90" cy="240" r="2" fill="#ffaa00" opacity="0.7">
              <animate attributeName="cx" values="90;85;90" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.7;0.1;0.7" dur="1.2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="110" cy="260" r="2.5" fill="#cc3300" opacity="0.8">
              <animate attributeName="cx" values="110;115;110" dur="0.9s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.2;0.8" dur="0.9s" repeatCount="indefinite"/>
            </circle>
          </g>
          
          <!-- Phoenix Wing Effects -->
          <path d="M85,240 Q75,220 85,210 Q90,215 85,240" fill="#ff6b35" opacity="0.4">
            <animate attributeName="opacity" values="0.4;0.8;0.4" dur="2s" repeatCount="indefinite"/>
            <animateTransform attributeName="transform" type="scale" values="1;1.2;1" dur="2s" repeatCount="indefinite"/>
          </path>
          <path d="M115,260 Q125,280 115,290 Q110,285 115,260" fill="#ff4400" opacity="0.4">
            <animate attributeName="opacity" values="0.4;0.8;0.4" dur="2.2s" repeatCount="indefinite"/>
            <animateTransform attributeName="transform" type="scale" values="1;1.2;1" dur="2.2s" repeatCount="indefinite"/>
          </path>
        </g>

        <!-- FROST BOW EFFECTS -->
        <g id="bow-frost-effects" opacity="0" style="display:none">
          <!-- Frost Crystal Aura -->
          <circle cx="100" cy="250" r="28" fill="url(#frostBowCrystals)" opacity="0.5">
            <animate attributeName="r" values="28;38;28" dur="4s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.5;0.8;0.5" dur="4s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Ice Crystals -->
          <g class="frost-crystals">
            <polygon points="85,225 83,222 85,219 87,222" fill="#4ecdc4" opacity="0.9">
              <animateTransform attributeName="transform" type="rotate" values="0 85 225;360 85 225" dur="6s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.9;0.4;0.9" dur="3s" repeatCount="indefinite"/>
            </polygon>
            <polygon points="115,275 112,272 115,269 118,272" fill="#66ccff" opacity="0.8">
              <animateTransform attributeName="transform" type="rotate" values="360 115 275;0 115 275" dur="5s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.3;0.8" dur="2.5s" repeatCount="indefinite"/>
            </polygon>
            <polygon points="95,235 93,233 95,231 97,233" fill="#87ceeb" opacity="0.7">
              <animateTransform attributeName="transform" type="rotate" values="0 95 235;360 95 235" dur="7s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.7;0.2;0.7" dur="3.5s" repeatCount="indefinite"/>
            </polygon>
          </g>
          
          <!-- Frost Trails -->
          <g class="frost-trails" opacity="0.6">
            <path d="M80,250 Q90,240 100,250 Q110,260 120,250" fill="none" stroke="#4ecdc4" stroke-width="1.5" opacity="0.6">
              <animate attributeName="stroke-dasharray" values="0,50;25,25;50,0;0,50" dur="3s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.6;0.2;0.6" dur="2s" repeatCount="indefinite"/>
            </path>
          </g>
        </g>

        <!-- THUNDER BOW EFFECTS -->
        <g id="bow-thunder-effects" opacity="0" style="display:none">
          <!-- Lightning Aura -->
          <circle cx="100" cy="250" r="32" fill="url(#thunderBowLightning)" opacity="0.7">
            <animate attributeName="r" values="32;42;32" dur="1s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.7;1;0.7" dur="1s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Lightning Bolts -->
          <g class="thunder-lightning">
            <path d="M85,220 L88,230 L85,235 L90,245 L85,250" fill="none" stroke="#ffe66d" stroke-width="2" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="0.1s" begin="0s;2s;4s" repeatCount="indefinite"/>
            </path>
            <path d="M115,280 L112,270 L115,265 L110,255 L115,250" fill="none" stroke="#ffcc00" stroke-width="2" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="0.1s" begin="1s;3s;5s" repeatCount="indefinite"/>
            </path>
            <path d="M90,240 L95,245 L100,240 L105,245 L110,240" fill="none" stroke="#ffffff" stroke-width="1.5" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="0.08s" begin="0.5s;2.5s;4.5s" repeatCount="indefinite"/>
            </path>
          </g>
          
          <!-- Electric Sparks -->
          <g class="thunder-sparks">
            <circle cx="88" cy="240" r="1" fill="#ffe66d" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="0.2s" begin="0.5s;3s" repeatCount="indefinite"/>
              <animate attributeName="r" values="1;3;1" dur="0.2s" begin="0.5s;3s" repeatCount="indefinite"/>
            </circle>
            <circle cx="112" cy="260" r="1" fill="#ffcc00" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="0.2s" begin="1.5s;4s" repeatCount="indefinite"/>
              <animate attributeName="r" values="1;3;1" dur="0.2s" begin="1.5s;4s" repeatCount="indefinite"/>
            </circle>
          </g>
        </g>

        <!-- VOID BOW EFFECTS -->
        <g id="bow-void-effects" opacity="0" style="display:none">
          <!-- Void Darkness Aura -->
          <circle cx="100" cy="250" r="35" fill="url(#voidBowDarkness)" opacity="0.6">
            <animate attributeName="r" values="35;50;35" dur="2.5s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.6;0.9;0.6" dur="2.5s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Dark Energy Swirls -->
          <g class="void-swirls">
            <path d="M80,250 Q90,230 100,250 Q110,270 120,250 Q110,230 100,250 Q90,270 80,250" 
                  fill="none" stroke="#ff0080" stroke-width="2" opacity="0.8">
              <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0;0,100" dur="3s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.3;0.8" dur="2s" repeatCount="indefinite"/>
            </path>
          </g>
          
          <!-- Void Particles -->
          <g class="void-particles">
            <circle cx="85" cy="235" r="2" fill="#ff0080" opacity="0.9">
              <animate attributeName="cx" values="85;95;85" dur="2s" repeatCount="indefinite"/>
              <animate attributeName="cy" values="235;245;235" dur="2s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.9;0.2;0.9" dur="2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="115" cy="265" r="1.5" fill="#cc0066" opacity="0.8">
              <animate attributeName="cx" values="115;105;115" dur="1.8s" repeatCount="indefinite"/>
              <animate attributeName="cy" values="265;255;265" dur="1.8s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.8;0.1;0.8" dur="1.8s" repeatCount="indefinite"/>
            </circle>
            <circle cx="100" cy="230" r="1" fill="#880044" opacity="0.7">
              <animate attributeName="cy" values="230;270;230" dur="3s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.7;0.1;0.7" dur="3s" repeatCount="indefinite"/>
            </circle>
          </g>
          
          <!-- Void Distortion Effect -->
          <ellipse cx="100" cy="250" rx="20" ry="8" fill="none" stroke="#ff0080" stroke-width="1" opacity="0.4">
            <animate attributeName="rx" values="20;30;20" dur="2s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.4;0.8;0.4" dur="2s" repeatCount="indefinite"/>
            <animateTransform attributeName="transform" type="rotate" values="0 100 250;360 100 250" dur="4s" repeatCount="indefinite"/>
          </ellipse>
        </g>
        
        <!-- Bow Energy Field (Universal) -->
        <circle cx="100" cy="250" r="0" fill="url(#natureBowGradient)" opacity="0" id="bowEnergyField">
          <animate attributeName="r" values="0;40;0" dur="0.4s" begin="indefinite"/>
          <animate attributeName="opacity" values="0;0.8;0" dur="0.4s" begin="indefinite"/>
        </circle>
        
        <!-- String Vibration Effects -->
        <g id="stringVibration" opacity="0">
          <circle cx="95" cy="225" r="1.5" fill="#88ce02" opacity="1">
            <animate attributeName="cy" values="225;223;225" dur="0.05s" repeatCount="20"/>
            <animate attributeName="opacity" values="1;0.3;0" dur="1s"/>
          </circle>
          <circle cx="98" cy="245" r="1.2" fill="#88ce02" opacity="0.9">
            <animate attributeName="cx" values="98;101;98" dur="0.05s" repeatCount="20"/>
            <animate attributeName="opacity" values="0.9;0.2;0" dur="1s"/>
          </circle>
          <circle cx="95" cy="265" r="1.5" fill="#88ce02" opacity="1">
            <animate attributeName="cy" values="265;267;265" dur="0.05s" repeatCount="20"/>
            <animate attributeName="opacity" values="1;0.3;0" dur="1s"/>
          </circle>
        </g>
      </g>
      
      <g class="arrow-angle"><use x="100" y="250" xlink:href="#arrow-default" id="currentArrow"/></g>
      
      <clipPath id="mask">
        <polygon opacity=".5" points="0,0 1500,0 1500,200 970,290 950,240 925,220 875,280 890,295 920,310 0,350" pointer-events="none"/>
      </clipPath>
      
      <g class="arrows" clip-path="url(#mask)" pointer-events="none"></g>
      
      <g class="miss" fill="#aaa" opacity="0" transform="translate(0, 100)">
        <path d="M358 194L363 118 386 120 400 153 416 121 440 119 446 203 419 212 416 163 401 180 380 160 381 204"/>
        <path d="M450 120L458 200 475 192 474 121"/>
        <path d="M537 118L487 118 485 160 515 162 509 177 482 171 482 193 529 199 538 148 501 146 508 133 537 137"/>
        <path d="M540 202L543 178 570 186 569 168 544 167 546 122 590 116 586 142 561 140 560 152 586 153 586 205"/>
        <path d="M595,215l5-23l31,0l-5,29L595,215z M627,176l13-70l-41-0l-0,70L627,176z"/>
      </g>
      
      <g class="bullseye" fill="#F4531C" opacity="0">
        <path d="M322,159l15-21l-27-13l-32,13l15,71l41-14l7-32L322,159z M292,142h20l3,8l-16,8 L292,142z M321,182l-18,9l-4-18l23-2V182z"/>
        <path d="M340 131L359 125 362 169 381 167 386 123 405 129 392 183 351 186z"/>
        <path d="M413 119L402 188 450 196 454 175 422 175 438 120z"/>
        <path d="M432 167L454 169 466 154 451 151 478 115 453 113z"/>
        <path d="M524 109L492 112 466 148 487 155 491 172 464 167 463 184 502 191 513 143 487 141 496 125 517 126z"/>
        <path d="M537 114L512 189 558 199 566 174 533 175 539 162 553 164 558 150 543 145 547 134 566 148 575 124z"/>
        <path d="M577 118L587 158 570 198 587 204 626 118 606 118 598 141 590 112z"/>
        <path d="M635 122L599 198 643 207 649 188 624 188 630 170 639 178 645 162 637 158 649 143 662 151 670 134z"/>
        <path d="M649,220l4-21l28,4l-6,25L649,220z M681,191l40-79l-35-8L659,184L681,191z"/>
      </g>
      
      <g class="hit" fill="#ffcc00" opacity="0" transform="translate(180, -80) rotate(12)">
        <path d="M383 114L385 195 407 191 406 160 422 155 418 191 436 189 444 112 423 119 422 141 407 146 400 113"/>
        <path d="M449 185L453 113 477 112 464 186"/>
        <path d="M486 113L484 130 506 130 481 188 506 187 520 131 540 135 545 119"/>
        <path d="M526,195l5-20l22,5l-9,16L526,195z M558,164l32-44l-35-9l-19,51L558,164z"/>
      </g>
    </svg>

    <span>üî• Open Settings for theme edits üèπ‚ö°‚ùÑÔ∏è‚ú®</span>
    
    <script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js'></script>
    <script src='//s3-us-west-2.amazonaws.com/s.cdpn.io/16327/MorphSVGPlugin.min.js'></script>
    <script>
      // ====== CREATIVE LOCAL SOUND EFFECTS SYSTEM ======
      class CreativeSoundEngine {
        constructor() {
          this.audioContext = null;
          this.masterGain = null;
          this.isInitialized = false;
          this.activeOscillators = [];
          this.reverbNode = null;
          
          this.initializeOnUserAction();
        }

        async initializeOnUserAction() {
          document.addEventListener('click', async () => {
            if (!this.isInitialized) {
              await this.initialize();
            }
          }, { once: true });
        }

        async initialize() {
          try {
            this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            this.masterGain = this.audioContext.createGain();
            this.masterGain.connect(this.audioContext.destination);
            this.masterGain.gain.value = 0.3;

            this.createReverb();
            this.isInitialized = true;
            
            this.showAudioIndicator("üîä Audio Ready!");
            console.log("Creative Sound Engine Initialized!");
          } catch (error) {
            console.warn("Audio initialization failed:", error);
          }
        }

        createReverb() {
          this.reverbNode = this.audioContext.createConvolver();
          const length = this.audioContext.sampleRate * 2;
          const impulse = this.audioContext.createBuffer(2, length, this.audioContext.sampleRate);
          
          for (let channel = 0; channel < 2; channel++) {
            const channelData = impulse.getChannelData(channel);
            for (let i = 0; i < length; i++) {
              channelData[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / length, 2);
            }
          }
          
          this.reverbNode.buffer = impulse;
          this.reverbNode.connect(this.masterGain);
        }

        showAudioIndicator(text) {
          const indicator = document.getElementById('audioIndicator');
          indicator.textContent = text;
          indicator.classList.add('show');
          setTimeout(() => indicator.classList.remove('show'), 2000);
        }

        // BOW DRAWING SOUND
        playBowDraw(tension = 0.5) {
          if (!this.isInitialized) return;
          
          const osc = this.audioContext.createOscillator();
          const gain = this.audioContext.createGain();
          const filter = this.audioContext.createBiquadFilter();
          
          osc.type = 'sawtooth';
          osc.frequency.setValueAtTime(80 + (tension * 60), this.audioContext.currentTime);
          
          filter.type = 'lowpass';
          filter.frequency.setValueAtTime(200 + (tension * 300), this.audioContext.currentTime);
          filter.Q.value = 8;
          
          gain.gain.setValueAtTime(0, this.audioContext.currentTime);
          gain.gain.linearRampToValueAtTime(tension * 0.2, this.audioContext.currentTime + 0.1);
          
          osc.connect(filter);
          filter.connect(gain);
          gain.connect(this.masterGain);
          
          osc.start();
          
          const harmonic = this.audioContext.createOscillator();
          const harmonicGain = this.audioContext.createGain();
          
          harmonic.type = 'triangle';
          harmonic.frequency.setValueAtTime(osc.frequency.value * 1.5, this.audioContext.currentTime);
          harmonicGain.gain.setValueAtTime(tension * 0.1, this.audioContext.currentTime);
          
          harmonic.connect(harmonicGain);
          harmonicGain.connect(this.masterGain);
          harmonic.start();
          
          this.activeOscillators.push({ osc, gain, harmonic, harmonicGain });
          
          return { osc, gain, harmonic, harmonicGain };
        }

        // BOW RELEASE SOUND
        playBowRelease(power = 1.0) {
          if (!this.isInitialized) return;
          
          this.showAudioIndicator("üèπ RELEASE!");
          this.stopBowDraw();
          
          const snap = this.audioContext.createOscillator();
          const snapGain = this.audioContext.createGain();
          const snapFilter = this.audioContext.createBiquadFilter();
          
          snap.type = 'square';
          snap.frequency.setValueAtTime(220, this.audioContext.currentTime);
          snap.frequency.exponentialRampToValueAtTime(80, this.audioContext.currentTime + 0.1);
          
          snapFilter.type = 'bandpass';
          snapFilter.frequency.value = 300;
          snapFilter.Q.value = 10;
          
          snapGain.gain.setValueAtTime(power * 0.4, this.audioContext.currentTime);
          snapGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.15);
          
          snap.connect(snapFilter);
          snapFilter.connect(snapGain);
          snapGain.connect(this.masterGain);
          
          snap.start();
          snap.stop(this.audioContext.currentTime + 0.15);
          
          setTimeout(() => this.playArrowWhoosh(power), 50);
        }

        stopBowDraw() {
          this.activeOscillators.forEach(({ osc, gain, harmonic, harmonicGain }) => {
            try {
              gain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.1);
              harmonicGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.1);
              osc.stop(this.audioContext.currentTime + 0.1);
              harmonic.stop(this.audioContext.currentTime + 0.1);
            } catch (e) {}
          });
          this.activeOscillators = [];
        }

        playArrowWhoosh(intensity = 1.0) {
          if (!this.isInitialized) return;
          
          const duration = 0.6;
          const noise = this.audioContext.createBufferSource();
          const noiseBuffer = this.audioContext.createBuffer(1, this.audioContext.sampleRate * duration, this.audioContext.sampleRate);
          const noiseData = noiseBuffer.getChannelData(0);
          
          for (let i = 0; i < noiseData.length; i++) {
            noiseData[i] = (Math.random() * 2 - 1) * 0.3;
          }
          
          noise.buffer = noiseBuffer;
          
          const filter = this.audioContext.createBiquadFilter();
          filter.type = 'bandpass';
          filter.frequency.setValueAtTime(1000, this.audioContext.currentTime);
          filter.frequency.exponentialRampToValueAtTime(300, this.audioContext.currentTime + duration);
          filter.Q.value = 2;
          
          const gain = this.audioContext.createGain();
          gain.gain.setValueAtTime(intensity * 0.3, this.audioContext.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
          
          noise.connect(filter);
          filter.connect(gain);
          gain.connect(this.masterGain);
          
          noise.start();
          noise.stop(this.audioContext.currentTime + duration);
        }

        // FIRE ARROW EFFECTS
        playFireArrowEffects() {
          this.showAudioIndicator("üî• FIRE ARROW!");
          this.playArrowWhoosh(1.2);
          
          const crackle = this.audioContext.createBufferSource();
          const crackleBuffer = this.audioContext.createBuffer(1, this.audioContext.sampleRate * 0.8, this.audioContext.sampleRate);
          const crackleData = crackleBuffer.getChannelData(0);
          
          for (let i = 0; i < crackleData.length; i++) {
            crackleData[i] = (Math.random() * 2 - 1) * Math.sin(i * 0.01) * 0.2;
          }
          
          crackle.buffer = crackleBuffer;
          
          const crackleGain = this.audioContext.createGain();
          crackleGain.gain.setValueAtTime(0.25, this.audioContext.currentTime);
          crackleGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.8);
          
          const crackleFilter = this.audioContext.createBiquadFilter();
          crackleFilter.type = 'highpass';
          crackleFilter.frequency.value = 2000;
          
          crackle.connect(crackleFilter);
          crackleFilter.connect(crackleGain);
          crackleGain.connect(this.masterGain);
          
          crackle.start();
          crackle.stop(this.audioContext.currentTime + 0.8);
        }

        // ICE ARROW EFFECTS
        playIceArrowEffects() {
          this.showAudioIndicator("‚ùÑÔ∏è ICE ARROW!");
          this.playArrowWhoosh(0.9);
          
          const crystal = this.audioContext.createOscillator();
          const crystalGain = this.audioContext.createGain();
          const crystalFilter = this.audioContext.createBiquadFilter();
          
          crystal.type = 'sine';
          crystal.frequency.setValueAtTime(800, this.audioContext.currentTime);
          crystal.frequency.linearRampToValueAtTime(1200, this.audioContext.currentTime + 0.3);
          crystal.frequency.linearRampToValueAtTime(600, this.audioContext.currentTime + 0.6);
          
          crystalFilter.type = 'bandpass';
          crystalFilter.frequency.value = 1000;
          crystalFilter.Q.value = 15;
          
          crystalGain.gain.setValueAtTime(0.2, this.audioContext.currentTime);
          crystalGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.6);
          
          crystal.connect(crystalFilter);
          crystalFilter.connect(crystalGain);
          crystalGain.connect(this.reverbNode);
          
          crystal.start();
          crystal.stop(this.audioContext.currentTime + 0.6);
        }

        // GOLD ARROW EFFECTS
        playGoldArrowEffects() {
          this.showAudioIndicator("‚ú® DIVINE ARROW!");
          this.playArrowWhoosh(1.5);
          
          const frequencies = [523.25, 659.25, 783.99, 1046.50];
          
          frequencies.forEach((freq, index) => {
            setTimeout(() => {
              const chime = this.audioContext.createOscillator();
              const chimeGain = this.audioContext.createGain();
              
              chime.type = 'sine';
              chime.frequency.value = freq;
              
              chimeGain.gain.setValueAtTime(0, this.audioContext.currentTime);
              chimeGain.gain.exponentialRampToValueAtTime(0.15, this.audioContext.currentTime + 0.05);
              chimeGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 1.5);
              
              chime.connect(chimeGain);
              chimeGain.connect(this.reverbNode);
              
              chime.start();
              chime.stop(this.audioContext.currentTime + 1.5);
            }, index * 100);
          });
        }

        // TARGET HIT SOUNDS
        playTargetHit(distance) {
          if (!this.isInitialized) return;
          
          const isBullseye = distance < 7;
          
          if (isBullseye) {
            this.showAudioIndicator("üéØ BULLSEYE!");
            this.playBullseyeHit();
          } else {
            this.showAudioIndicator("üéØ HIT!");
            this.playRegularHit();
          }
        }

        playBullseyeHit() {
          const impact = this.audioContext.createOscillator();
          const impactGain = this.audioContext.createGain();
          
          impact.type = 'triangle';
          impact.frequency.setValueAtTime(150, this.audioContext.currentTime);
          impact.frequency.exponentialRampToValueAtTime(80, this.audioContext.currentTime + 0.3);
          
          impactGain.gain.setValueAtTime(0.4, this.audioContext.currentTime);
          impactGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.3);
          
          impact.connect(impactGain);
          impactGain.connect(this.masterGain);
          
          impact.start();
          impact.stop(this.audioContext.currentTime + 0.3);
          
          setTimeout(() => {
            const chord = [261.63, 329.63, 392.00];
            chord.forEach((freq, index) => {
              setTimeout(() => {
                const note = this.audioContext.createOscillator();
                const noteGain = this.audioContext.createGain();
                
                note.type = 'sine';
                note.frequency.value = freq;
                
                noteGain.gain.setValueAtTime(0.15, this.audioContext.currentTime);
                noteGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 2);
                
                note.connect(noteGain);
                noteGain.connect(this.reverbNode);
                
                note.start();
                note.stop(this.audioContext.currentTime + 2);
              }, index * 50);
            });
          }, 200);
        }

        playRegularHit() {
          const thunk = this.audioContext.createOscillator();
          const thunkGain = this.audioContext.createGain();
          const thunkFilter = this.audioContext.createBiquadFilter();
          
          thunk.type = 'sawtooth';
          thunk.frequency.setValueAtTime(120, this.audioContext.currentTime);
          thunk.frequency.exponentialRampToValueAtTime(60, this.audioContext.currentTime + 0.2);
          
          thunkFilter.type = 'lowpass';
          thunkFilter.frequency.value = 400;
          
          thunkGain.gain.setValueAtTime(0.3, this.audioContext.currentTime);
          thunkGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.2);
          
          thunk.connect(thunkFilter);
          thunkFilter.connect(thunkGain);
          thunkGain.connect(this.masterGain);
          
          thunk.start();
          thunk.stop(this.audioContext.currentTime + 0.2);
        }

        playMissSound() {
          this.showAudioIndicator("üòû MISS!");
          
          const trombone = this.audioContext.createOscillator();
          const tromboneGain = this.audioContext.createGain();
          
          trombone.type = 'sawtooth';
          trombone.frequency.setValueAtTime(220, this.audioContext.currentTime);
          trombone.frequency.exponentialRampToValueAtTime(110, this.audioContext.currentTime + 1);
          
          tromboneGain.gain.setValueAtTime(0.2, this.audioContext.currentTime);
          tromboneGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 1);
          
          trombone.connect(tromboneGain);
          tromboneGain.connect(this.masterGain);
          
          trombone.start();
          trombone.stop(this.audioContext.currentTime + 1);
        }

        playUIClick() {
          if (!this.isInitialized) return;
          
          const click = this.audioContext.createOscillator();
          const clickGain = this.audioContext.createGain();
          
          click.type = 'sine';
          click.frequency.value = 800;
          
          clickGain.gain.setValueAtTime(0.1, this.audioContext.currentTime);
          clickGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.1);
          
          click.connect(clickGain);
          clickGain.connect(this.masterGain);
          
          click.start();
          click.stop(this.audioContext.currentTime + 0.1);
        }

        playUIHover() {
          if (!this.isInitialized) return;
          
          const hover = this.audioContext.createOscillator();
          const hoverGain = this.audioContext.createGain();
          
          hover.type = 'sine';
          hover.frequency.value = 600;
          
          hoverGain.gain.setValueAtTime(0.05, this.audioContext.currentTime);
          hoverGain.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.08);
          
          hover.connect(hoverGain);
          hoverGain.connect(this.masterGain);
          
          hover.start();
          hover.stop(this.audioContext.currentTime + 0.08);
        }
      }

      // Initialize sound engine
      const soundEngine = new CreativeSoundEngine();

      // ====== PARTICLE SYSTEM ======
      class AAA_ParticleSystem {
        constructor() {
          this.particleCanvas = document.getElementById('particleCanvas');
          this.lightingCanvas = document.getElementById('lightingCanvas');
          this.atmosphereCanvas = document.getElementById('atmosphereCanvas');
          
          this.particleCtx = this.particleCanvas.getContext('2d');
          this.lightingCtx = this.lightingCanvas.getContext('2d');
          this.atmosphereCtx = this.atmosphereCanvas.getContext('2d');
          
          this.particles = [];
          this.resize();
          window.addEventListener('resize', () => this.resize());
          this.animate();
        }

        resize() {
          const width = window.innerWidth;
          const height = window.innerHeight;
          
          this.particleCanvas.width = width;
          this.particleCanvas.height = height;
          this.lightingCanvas.width = width;
          this.lightingCanvas.height = height;
          this.atmosphereCanvas.width = width;
          this.atmosphereCanvas.height = height;
        }

        createFireExplosion(x, y) {
          for (let i = 0; i < 60; i++) {
            this.particles.push(new FireParticle(x, y));
          }
        }

        createIceExplosion(x, y) {
          for (let i = 0; i < 45; i++) {
            this.particles.push(new IceParticle(x, y));
          }
        }

        createGoldExplosion(x, y) {
          for (let i = 0; i < 70; i++) {
            this.particles.push(new GoldParticle(x, y));
          }
        }

        createBowBurst(x, y) {
          for (let i = 0; i < 25; i++) {
            this.particles.push(new EnergyParticle(x, y));
          }
        }

        createShockwave(x, y) {
          this.particles.push(new ShockwaveParticle(x, y));
        }

        update() {
          this.particles = this.particles.filter(particle => {
            particle.update();
            return particle.life > 0;
          });
        }

        render() {
          this.particleCtx.clearRect(0, 0, this.particleCanvas.width, this.particleCanvas.height);
          this.lightingCtx.clearRect(0, 0, this.lightingCanvas.width, this.lightingCanvas.height);
          this.atmosphereCtx.clearRect(0, 0, this.atmosphereCanvas.width, this.atmosphereCanvas.height);

          this.particles.forEach(particle => particle.render(this.particleCtx));
        }

        animate() {
          this.update();
          this.render();
          requestAnimationFrame(() => this.animate());
        }
      }

      // Particle classes
      class FireParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 8 + 2;
          this.vx = Math.cos(angle) * speed;
          this.vy = Math.sin(angle) * speed - Math.random() * 3;
          this.life = 1;
          this.decay = Math.random() * 0.02 + 0.01;
          this.size = Math.random() * 6 + 2;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;
          this.vy -= 0.1;
          this.vx *= 0.98;
          this.vy *= 0.98;
          this.life -= this.decay;
          this.size *= 0.98;
        }

        render(ctx) {
          if (this.life <= 0) return;
          
          const alpha = this.life;
          const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
          gradient.addColorStop(0, `rgba(255, 255, 255, ${alpha})`);
          gradient.addColorStop(0.3, `rgba(255, 200, 0, ${alpha * 0.8})`);
          gradient.addColorStop(0.7, `rgba(255, 100, 0, ${alpha * 0.6})`);
          gradient.addColorStop(1, `rgba(200, 0, 0, 0)`);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      class IceParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 6 + 2;
          this.vx = Math.cos(angle) * speed;
          this.vy = Math.sin(angle) * speed;
          this.life = 1;
          this.decay = Math.random() * 0.015 + 0.005;
          this.size = Math.random() * 4 + 1;
          this.rotation = Math.random() * Math.PI * 2;
          this.rotationSpeed = (Math.random() - 0.5) * 0.2;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;
          this.vx *= 0.96;
          this.vy *= 0.96;
          this.rotation += this.rotationSpeed;
          this.life -= this.decay;
        }

        render(ctx) {
          if (this.life <= 0) return;

          ctx.save();
          ctx.translate(this.x, this.y);
          ctx.rotate(this.rotation);
          
          const alpha = this.life;
          const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, this.size * 2);
          gradient.addColorStop(0, `rgba(255, 255, 255, ${alpha})`);
          gradient.addColorStop(0.4, `rgba(200, 230, 255, ${alpha * 0.8})`);
          gradient.addColorStop(1, `rgba(100, 150, 255, 0)`);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          for (let i = 0; i < 6; i++) {
            const angle = (i * Math.PI) / 3;
            const x = Math.cos(angle) * this.size;
            const y = Math.sin(angle) * this.size;
            if (i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
          }
          ctx.closePath();
          ctx.fill();
          
          ctx.restore();
        }
      }

      class GoldParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 10 + 3;
          this.vx = Math.cos(angle) * speed;
          this.vy = Math.sin(angle) * speed - Math.random() * 2;
          this.life = 1;
          this.decay = Math.random() * 0.02 + 0.01;
          this.size = Math.random() * 3 + 1;
          this.sparkle = Math.random() > 0.7;
          this.twinkle = 0;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;
          this.vy += 0.1;
          this.vx *= 0.97;
          this.vy *= 0.97;
          this.life -= this.decay;
          this.twinkle += 0.3;
        }

        render(ctx) {
          if (this.life <= 0) return;

          const alpha = this.life;
          const sparkleAlpha = this.sparkle ? Math.sin(this.twinkle) * 0.5 + 0.5 : 1;
          
          const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 2);
          gradient.addColorStop(0, `rgba(255, 255, 255, ${alpha * sparkleAlpha})`);
          gradient.addColorStop(0.3, `rgba(255, 220, 0, ${alpha * 0.9})`);
          gradient.addColorStop(1, `rgba(255, 150, 0, 0)`);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();

          if (this.sparkle && sparkleAlpha > 0.8) {
            ctx.strokeStyle = `rgba(255, 255, 255, ${alpha})`;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(this.x - this.size * 2, this.y);
            ctx.lineTo(this.x + this.size * 2, this.y);
            ctx.moveTo(this.x, this.y - this.size * 2);
            ctx.lineTo(this.x, this.y + this.size * 2);
            ctx.stroke();
          }
        }
      }

      class EnergyParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 6 + 2;
          this.vx = Math.cos(angle) * speed;
          this.vy = Math.sin(angle) * speed;
          this.life = 1;
          this.decay = Math.random() * 0.03 + 0.02;
          this.size = Math.random() * 3 + 1;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;
          this.vx *= 0.95;
          this.vy *= 0.95;
          this.life -= this.decay;
        }

        render(ctx) {
          if (this.life <= 0) return;

          const alpha = this.life;
          const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 3);
          gradient.addColorStop(0, `rgba(136, 206, 2, ${alpha})`);
          gradient.addColorStop(1, `rgba(136, 206, 2, 0)`);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      class ShockwaveParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          this.radius = 0;
          this.maxRadius = 100;
          this.life = 1;
          this.decay = 0.02;
          this.expandSpeed = 4;
        }

        update() {
          this.radius += this.expandSpeed;
          this.life -= this.decay;
          if (this.radius > this.maxRadius) this.life = 0;
        }

        render(ctx) {
          if (this.life <= 0) return;

          const alpha = this.life * 0.7;
          ctx.strokeStyle = `rgba(255, 255, 255, ${alpha})`;
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          ctx.stroke();
        }
      }

      // Initialize Systems
      const aaaParticleSystem = new AAA_ParticleSystem();

      // ====== GAME VARIABLES ======
      var svg = document.querySelector("svg");
      var cursor = svg.createSVGPoint();
      var arrows = document.querySelector(".arrows");
      var randomAngle = 0;
      var currentArrowStyle = 'default';
      var currentTargetStyle = 'classic';
      var currentBowColor = '#88ce02';
      var currentBowTheme = 'nature'; // Track current bow theme
      var currentBowDraw = null;
      var isPanelOpen = true;

      var target = {
        x: 900,
        y: 249.5
      };

      var lineSegment = {
        x1: 875,
        y1: 280,
        x2: 925,
        y2: 220
      };

      var pivot = {
        x: 100,
        y: 250
      };
      
      aim({
        clientX: 320,
        clientY: 300
      });

      // ====== UI FUNCTIONS WITH SOUND + BOW THEME SWITCHING ======
      function openPanel() {
        const panel = document.getElementById('customPanel');
        const openBtn = document.getElementById('openBtn');
        
        panel.classList.remove('panel-closed');
        openBtn.style.display = 'none';
        isPanelOpen = true;
        
        soundEngine.playUIClick();
      }

      function closePanel() {
        const panel = document.getElementById('customPanel');
        const openBtn = document.getElementById('openBtn');
        
        panel.classList.add('panel-closed');
        openBtn.style.display = 'flex';
        isPanelOpen = false;
        
        soundEngine.playUIClick();
      }

      function changeArrowStyle(style, event) {
        event.stopPropagation();
        currentArrowStyle = style;
        document.getElementById('currentArrow').setAttribute('href', '#arrow-' + style);
        setActiveButton('.option-group:nth-child(1)', style);
        switchTrajectoryEffects(style);
        soundEngine.playUIClick();
      }

      function switchTrajectoryEffects(arrowStyle) {
        document.getElementById('trajectory-default').style.display = 'none';
        document.getElementById('trajectory-fire').style.display = 'none';
        document.getElementById('trajectory-ice').style.display = 'none';
        document.getElementById('trajectory-gold').style.display = 'none';
        
        document.getElementById('trajectory-' + arrowStyle).style.display = 'block';
      }

      function changeTargetStyle(style, event) {
        event.stopPropagation();
        document.getElementById('target-classic').style.display = 'none';
        document.getElementById('target-modern').style.display = 'none';
        document.getElementById('target-neon').style.display = 'none';
        document.getElementById('target-wooden').style.display = 'none';
        
        document.getElementById('target-' + style).style.display = 'block';
        currentTargetStyle = style;
        setActiveButton('.option-group:nth-child(2)', style);
        soundEngine.playUIClick();
      }

      // ENHANCED: Bow Color Change with Extreme Theme Effects
      function changeBowColor(color, event) {
        event.stopPropagation();
        currentBowColor = color;
        
        // Update bow string color
        document.getElementById('bowString').setAttribute('stroke', color);
        
        // Update bow energy gradient color
        const bowEnergyField = document.getElementById('bowEnergyField');
        
        // Determine theme based on color and switch bow effects
        let theme = 'nature';
        if (color === '#ff6b35') theme = 'phoenix';
        else if (color === '#4ecdc4') theme = 'frost';
        else if (color === '#ffe66d') theme = 'thunder';
        else if (color === '#ff0080') theme = 'void';
        
        switchBowTheme(theme);
        currentBowTheme = theme;
        
        setActiveButton('.option-group:nth-child(3)', color);
        soundEngine.playUIClick();
      }

      // NEW: Switch Bow Theme Effects
      function switchBowTheme(theme) {
        // Hide all bow effect groups
        document.getElementById('bow-nature-effects').style.display = 'none';
        document.getElementById('bow-phoenix-effects').style.display = 'none';
        document.getElementById('bow-frost-effects').style.display = 'none';
        document.getElementById('bow-thunder-effects').style.display = 'none';
        document.getElementById('bow-void-effects').style.display = 'none';
        
        // Show the selected theme effects
        const selectedTheme = document.getElementById('bow-' + theme + '-effects');
        selectedTheme.style.display = 'block';
        selectedTheme.style.opacity = '1';
        
        // Update the bow energy field gradient based on theme
        const bowEnergyField = document.getElementById('bowEnergyField');
        const gradientId = theme + 'BowGradient';
        bowEnergyField.setAttribute('fill', `url(#${gradientId})`);
        
        // Update string vibration colors
        const vibrationCircles = document.querySelectorAll('#stringVibration circle');
        vibrationCircles.forEach(circle => {
          circle.setAttribute('fill', currentBowColor);
        });
      }

      // Add hover sounds when DOM loads
      setTimeout(() => {
        const buttons = document.querySelectorAll('.option-btn, .close-btn, .open-btn');
        buttons.forEach(btn => {
          btn.addEventListener('mouseenter', () => soundEngine.playUIHover());
        });
      }, 1000);

      function setActiveButton(groupSelector, value) {
        const group = document.querySelector(groupSelector);
        const buttons = group.querySelectorAll('.option-btn');
        buttons.forEach(btn => btn.classList.remove('active'));
        
        const activeBtn = Array.from(buttons).find(btn => 
          btn.getAttribute('onclick').includes(value)
        );
        if (activeBtn) {
          activeBtn.classList.add('active');
        }
      }

      function svgToScreen(svgX, svgY) {
        const svgRect = svg.getBoundingClientRect();
        const svgViewBox = svg.viewBox.baseVal;
        
        const scaleX = svgRect.width / svgViewBox.width;
        const scaleY = svgRect.height / svgViewBox.height;
        
        return {
          x: svgRect.left + (svgX * scaleX),
          y: svgRect.top + (svgY * scaleY)
        };
      }

      function triggerBowEffects() {
        const energyField = document.getElementById('bowEnergyField');
        const animations = energyField.querySelectorAll('animate');
        animations.forEach(anim => anim.beginElement());
        
        const bowScreenCoords = svgToScreen(100, 250);
        aaaParticleSystem.createBowBurst(bowScreenCoords.x, bowScreenCoords.y);
        
        const stringVibration = document.getElementById('stringVibration');
        TweenMax.to(stringVibration, 1, {
          opacity: 1,
          onComplete: () => {
            TweenMax.to(stringVibration, 0.5, { opacity: 0 });
          }
        });
      }

      function isNearBow(mouseX, mouseY) {
        cursor.x = mouseX;
        cursor.y = mouseY;
        const svgPoint = cursor.matrixTransform(svg.getScreenCTM().inverse());
        
        const bowArea = {
          x: 50,
          y: 180,
          width: 200,
          height: 140
        };
        
        return svgPoint.x >= bowArea.x && 
               svgPoint.x <= bowArea.x + bowArea.width &&
               svgPoint.y >= bowArea.y && 
               svgPoint.y <= bowArea.y + bowArea.height;
      }

      // ====== GAME CONTROLS WITH SOUND ======
      window.addEventListener("mousedown", function(e) {
        if (isNearBow(e.clientX, e.clientY)) {
          draw(e);
        }
      });

      function draw(e) {
        randomAngle = (Math.random() * Math.PI * 0.03) - 0.015;
        TweenMax.to(".arrow-angle use", 0.3, { opacity: 1 });
        window.addEventListener("mousemove", aim);
        window.addEventListener("mouseup", loose);
        aim(e);
      }

      function aim(e) {
        var point = getMouseSVG(e);
        point.x = Math.min(point.x, pivot.x - 7);
        point.y = Math.max(point.y, pivot.y + 7);
        var dx = point.x - pivot.x;
        var dy = point.y - pivot.y;
        var angle = Math.atan2(dy, dx) + randomAngle;
        var bowAngle = angle - Math.PI;
        var distance = Math.min(Math.sqrt((dx * dx) + (dy * dy)), 50);
        var scale = Math.min(Math.max(distance / 30, 1), 2);
        
        // Play bow draw sound based on tension
        const tension = distance / 50;
        if (currentBowDraw) {
          soundEngine.stopBowDraw();
        }
        currentBowDraw = soundEngine.playBowDraw(tension);
        
        TweenMax.to("#bow", 0.3, {
          scaleX: scale,
          rotation: bowAngle + "rad",
          transformOrigin: "right center"
        });
        
        TweenMax.to(".arrow-angle", 0.3, {
          rotation: bowAngle + "rad",
          svgOrigin: "100 250"
        });
        
        TweenMax.to(".arrow-angle use", 0.3, { x: -distance });
        
        TweenMax.to("#bow polyline", 0.3, {
          attr: {
            points: "88,200 " + Math.min(pivot.x - ((1 / scale) * distance), 88) + ",250 88,300"
          }
        });

        var radius = distance * 9;
        var offset = {
          x: (Math.cos(bowAngle) * radius),
          y: (Math.sin(bowAngle) * radius)
        };
        var arcWidth = offset.x * 3;
        var newPath = "M100,250c" + offset.x + "," + offset.y + "," + (arcWidth - offset.x) + "," + (offset.y + 50) + "," + arcWidth + ",50";

        updateTrajectoryPaths(newPath, distance);
      }

      function updateTrajectoryPaths(pathData, distance) {
        const opacity = distance/60;
        
        TweenMax.to("#arc", 0.3, {
          attr: { d: pathData },
          autoAlpha: opacity
        });
        TweenMax.to("#arcGlow", 0.3, {
          attr: { d: pathData },
          opacity: opacity * 0.3
        });

        TweenMax.to("#arc-fire", 0.3, {
          attr: { d: pathData },
          autoAlpha: opacity
        });
        TweenMax.to("#arcGlow-fire", 0.3, {
          attr: { d: pathData },
          opacity: opacity * 0.4
        });

        TweenMax.to("#arc-ice", 0.3, {
          attr: { d: pathData },
          autoAlpha: opacity
        });
        TweenMax.to("#arcGlow-ice", 0.3, {
          attr: { d: pathData },
          opacity: opacity * 0.5
        });

        TweenMax.to("#arc-gold", 0.3, {
          attr: { d: pathData },
          autoAlpha: opacity
        });
        TweenMax.to("#arcGlow-gold", 0.3, {
          attr: { d: pathData },
          opacity: opacity * 0.6
        });
      }

      function loose() {
        window.removeEventListener("mousemove", aim);
        window.removeEventListener("mouseup", loose);

        // Play release sound with power
        const power = currentBowDraw ? 1.0 : 0.5;
        soundEngine.playBowRelease(power);
        currentBowDraw = null;

        triggerBowEffects();

        TweenMax.to("#bow", 0.4, {
          scaleX: 1,
          transformOrigin: "right center",
          ease: Elastic.easeOut
        });
        
        TweenMax.to("#bow polyline", 0.4, {
          attr: { points: "88,200 88,250 88,300" },
          ease: Elastic.easeOut
        });
        
        var newArrow = document.createElementNS("http://www.w3.org/2000/svg", "use");
        newArrow.setAttributeNS('http://www.w3.org/1999/xlink', 'href', "#arrow-" + currentArrowStyle);
        arrows.appendChild(newArrow);

        // Play arrow-specific sounds
        setTimeout(() => {
          switch(currentArrowStyle) {
            case 'fire':
              soundEngine.playFireArrowEffects();
              break;
            case 'ice':
              soundEngine.playIceArrowEffects();
              break;
            case 'gold':
              soundEngine.playGoldArrowEffects();
              break;
          }
        }, 100);

        var pathSelector = currentArrowStyle === 'default' ? "#arc" : "#arc-" + currentArrowStyle;
        var path = MorphSVGPlugin.pathDataToBezier(pathSelector);
        
        TweenMax.to([newArrow], 0.5, {
          force3D: true,
          bezier: {
            type: "cubic",
            values: path,
            autoRotate: ["x", "y", "rotation"]
          },
          onUpdate: hitTest,
          onUpdateParams: ["{self}"],
          onComplete: onMiss,
          ease: Linear.easeNone
        });
        
        TweenMax.to("#arc, #arc-fire, #arc-ice, #arc-gold", 0.3, { opacity: 0 });
        TweenMax.to("#arcGlow, #arcGlow-fire, #arcGlow-ice, #arcGlow-gold", 0.3, { opacity: 0 });
        
        TweenMax.set(".arrow-angle use", { opacity: 0 });
      }

      function hitTest(tween) {
        var arrow = tween.target[0];
        var transform = arrow._gsTransform;
        var radians = transform.rotation * Math.PI / 180;
        var arrowSegment = {
          x1: transform.x,
          y1: transform.y,
          x2: (Math.cos(radians) * 60) + transform.x,
          y2: (Math.sin(radians) * 60) + transform.y
        };

        var intersection = getIntersection(arrowSegment, lineSegment);
        if (intersection.segment1 && intersection.segment2) {
          tween.pause();
          
          const screenCoords = svgToScreen(intersection.x, intersection.y);
          aaaParticleSystem.createShockwave(screenCoords.x, screenCoords.y);
          
          switch(currentArrowStyle) {
            case 'fire':
              aaaParticleSystem.createFireExplosion(screenCoords.x, screenCoords.y);
              break;
            case 'ice':
              aaaParticleSystem.createIceExplosion(screenCoords.x, screenCoords.y);
              break;
            case 'gold':
              aaaParticleSystem.createGoldExplosion(screenCoords.x, screenCoords.y);
              break;
          }
          
          var dx = intersection.x - target.x;
          var dy = intersection.y - target.y;
          var distance = Math.sqrt((dx * dx) + (dy * dy));
          
          // Play hit sound with distance
          soundEngine.playTargetHit(distance);
          
          var selector = ".hit";
          if (distance < 7) {
            selector = ".bullseye";
            setTimeout(() => {
              aaaParticleSystem.createShockwave(screenCoords.x, screenCoords.y);
            }, 300);
          }
          showMessage(selector);
        }
      }

      function onMiss() {
        soundEngine.playMissSound();
        showMessage(".miss");
      }

      function showMessage(selector) {
        TweenMax.killTweensOf(selector);
        TweenMax.killChildTweensOf(selector);
        TweenMax.set(selector, { autoAlpha: 1 });
        TweenMax.staggerFromTo(selector + " path", .5, {
          rotation: -5,
          scale: 0,
          transformOrigin: "center"
        }, {
          scale: 1,
          ease: Back.easeOut
        }, .05);
        TweenMax.staggerTo(selector + " path", .3, {
          delay: 2,
          rotation: 20,
          scale: 0,
          ease: Back.easeIn
        }, .03);
      }

      function getMouseSVG(e) {
        cursor.x = e.clientX;
        cursor.y = e.clientY;
        return cursor.matrixTransform(svg.getScreenCTM().inverse());
      }

      function getIntersection(segment1, segment2) {
        var dx1 = segment1.x2 - segment1.x1;
        var dy1 = segment1.y2 - segment1.y1;
        var dx2 = segment2.x2 - segment2.x1;
        var dy2 = segment2.y2 - segment2.y1;
        var cx = segment1.x1 - segment2.x1;
        var cy = segment1.y1 - segment2.y1;
        var denominator = dy2 * dx1 - dx2 * dy1;
        if (denominator == 0) {
          return null;
        }
        var ua = (dx2 * cy - dy2 * cx) / denominator;
        var ub = (dx1 * cy - dy1 * cx) / denominator;
        return {
          x: segment1.x1 + ua * dx1,
          y: segment1.y1 + ua * dy1,
          segment1: ua >= 0 && ua <= 1,
          segment2: ub >= 0 && ub <= 1
        };
      }
    </script>
  </body>
</html>
